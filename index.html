<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>SYSTEM_OVERRIDE // LCTFD_ARCHIVE_3105</title>
<style>
    /* ==============================================================================================
       SECTION 1: GLOBAL RESET & VARIABLES
       ============================================================================================== */
    :root {
        --color-bg: #020202;
        --color-term: #00ff41;     /* Classic Terminal Green */
        --color-term-dim: #003b00; /* Dim Green */
        --color-alert: #ff003c;    /* Cyberpunk Red */
        --color-warn: #ffee00;     /* Warning Yellow */
        --color-cyan: #00f3ff;     /* Cyber Cyan */
        --font-mono: 'Courier New', Courier, monospace;
        --scanline-speed: 8s;
        --flicker-speed: 0.15s;
    }

    *, *::before, *::after {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        outline: none;
        user-select: none;
        -webkit-user-select: none;
        cursor: crosshair;
    }

    body {
        background-color: var(--color-bg);
        color: var(--color-term);
        font-family: var(--font-mono);
        height: 100vh;
        width: 100vw;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
        perspective: 1000px;
    }

    /* ==============================================================================================
       SECTION 2: BACKGROUND FX LAYERS
       ============================================================================================== */
    #fx-layer-matrix {
        position: fixed;
        top: 0; left: 0; width: 100%; height: 100%;
        z-index: 0;
        opacity: 0.15;
    }

    #fx-layer-scanlines {
        position: fixed;
        top: 0; left: 0; width: 100%; height: 100%;
        background: linear-gradient(
            to bottom,
            rgba(255,255,255,0),
            rgba(255,255,255,0) 50%,
            rgba(0,0,0,0.2) 50%,
            rgba(0,0,0,0.2)
        );
        background-size: 100% 4px;
        z-index: 100;
        pointer-events: none;
        animation: scanline-anim var(--scanline-speed) linear infinite;
    }

    #fx-layer-vignette {
        position: fixed;
        top: 0; left: 0; width: 100%; height: 100%;
        background: radial-gradient(circle, transparent 60%, black 100%);
        z-index: 99;
        pointer-events: none;
    }

    #fx-layer-noise {
        position: fixed;
        top: 0; left: 0; width: 100%; height: 100%;
        opacity: 0.05;
        z-index: 98;
        pointer-events: none;
        background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIj48ZmlsdGVyIGlkPSJmIj48ZmVUdXJidWxlbmNlIHR5cGU9ImZyYWN0YWxOb2lzZSIgYmFzZUZyZXF1ZW5jeT0iMC42NSIgbnVtT2N0YXZlcz0iMyIgc3RpdGNoVGlsZXM9InN0aXRjaCIvPjwvZmlsdGVyPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbHRlcj0idXJsKCNmKSIgb3BhY2l0eT0iMC41Ii8+PC9zdmc+');
    }

    @keyframes scanline-anim {
        0% { background-position: 0 0; }
        100% { background-position: 0 100%; }
    }

    /* ==============================================================================================
       SECTION 3: MAIN TERMINAL CONTAINER (RESPONSIVE)
       ============================================================================================== */
    #terminal-chassis {
        position: relative;
        z-index: 50;
        width: 95vw;
        max-width: 1200px;
        height: 90vh;
        max-height: 800px;
        background: rgba(5, 10, 5, 0.95);
        border: 2px solid var(--color-term);
        box-shadow: 
            0 0 20px var(--color-term),
            inset 0 0 50px rgba(0, 50, 0, 0.5);
        display: flex;
        flex-direction: column;
        transition: transform 0.1s;
        /* Default subtle 3D rotation */
        transform: rotateX(0.5deg) rotateY(0.5deg);
    }

    /* ==============================================================================================
       SECTION 4: TERMINAL HEADER UI
       ============================================================================================== */
    .term-header {
        height: 40px;
        border-bottom: 2px solid var(--color-term);
        background: var(--color-term-dim);
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 15px;
        font-size: 12px;
        letter-spacing: 1px;
    }

    .term-header-left, .term-header-right {
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .status-light {
        width: 10px;
        height: 10px;
        background: var(--color-term);
        border-radius: 50%;
        box-shadow: 0 0 5px var(--color-term);
        animation: blink 1s infinite;
    }

    @keyframes blink { 50% { opacity: 0.3; } }

    /* ==============================================================================================
       SECTION 5: TERMINAL BODY (VIEWPORT)
       ============================================================================================== */
    .term-body {
        flex: 1;
        position: relative;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 20px;
    }

    #loading-screen {
        position: absolute;
        top: 0; left: 0; width: 100%; height: 100%;
        background: var(--color-bg);
        z-index: 500;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }

    .loader-box {
        width: 300px;
        height: 20px;
        border: 2px solid var(--color-term);
        padding: 2px;
        margin-top: 10px;
    }
    .loader-bar {
        height: 100%;
        background: var(--color-term);
        width: 0%;
        transition: width 0.05s linear;
    }

    /* ==============================================================================================
       SECTION 6: GAME ELEMENTS
       ============================================================================================== */
    .level-indicator {
        position: absolute;
        top: 20px;
        right: 20px;
        font-size: 14px;
        color: #444;
    }

    #question-display {
        font-size: clamp(20px, 4vw, 36px);
        text-align: center;
        margin-bottom: 50px;
        text-transform: uppercase;
        max-width: 800px;
        line-height: 1.4;
        text-shadow: 2px 2px var(--color-alert);
        min-height: 80px; /* Prevent layout shift */
    }

    .btn-grid {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 20px;
        width: 100%;
        max-width: 800px;
        position: relative;
        min-height: 150px; /* Space for moving buttons */
    }

    .cy-btn {
        position: relative;
        background: transparent;
        color: var(--color-term);
        border: 2px solid var(--color-term);
        padding: 20px 40px;
        font-family: var(--font-mono);
        font-size: 18px;
        text-transform: uppercase;
        font-weight: bold;
        transition: all 0.1s;
        z-index: 10;
        min-width: 200px;
        text-align: center;
    }

    .cy-btn::before {
        content: '';
        position: absolute;
        top: 2px; left: 2px; right: 2px; bottom: 2px;
        background: var(--color-term);
        opacity: 0;
        z-index: -1;
        transition: opacity 0.1s;
    }

    .cy-btn:hover {
        color: #000;
        box-shadow: 0 0 20px var(--color-term);
    }
    .cy-btn:hover::before { opacity: 1; }
    .cy-btn:active { transform: scale(0.96); }

    /* ==============================================================================================
       SECTION 7: TROLL MODIFIER CLASSES
       ============================================================================================== */
    .mod-invisible { opacity: 0.03; cursor: none; }
    .mod-tiny { transform: scale(0.2); }
    .mod-spin { animation: spin 0.5s infinite linear; }
    .mod-shake { animation: shake-btn 0.2s infinite; }
    .mod-red-theme { color: var(--color-alert); border-color: var(--color-alert); }
    .mod-red-theme:hover { background: var(--color-alert); color: black; box-shadow: 0 0 20px var(--color-alert); }

    @keyframes spin { 100% { transform: rotate(360deg); } }
    @keyframes shake-btn {
        0% { transform: translate(0,0); }
        25% { transform: translate(-2px, 2px); }
        50% { transform: translate(2px, -2px); }
        75% { transform: translate(-2px, -2px); }
        100% { transform: translate(0,0); }
    }

    /* ==============================================================================================
       SECTION 8: SYSTEM LOG CONSOLE (BOTTOM)
       ============================================================================================== */
    .term-footer {
        height: 150px;
        border-top: 2px solid var(--color-term);
        background: #000;
        padding: 10px;
        font-size: 11px;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        font-family: 'Lucida Console', monospace;
        color: #666;
    }
    
    .term-footer::-webkit-scrollbar { width: 5px; background: #111; }
    .term-footer::-webkit-scrollbar-thumb { background: var(--color-term); }

    .log-entry { margin-bottom: 2px; }
    .log-sys { color: #666; }
    .log-warn { color: var(--color-warn); }
    .log-err { color: var(--color-alert); }
    .log-ok { color: var(--color-term); }

    /* ==============================================================================================
       SECTION 9: BSOD OVERLAY
       ============================================================================================== */
    #bsod-layer {
        display: none;
        position: fixed;
        top: 0; left: 0; width: 100vw; height: 100vh;
        background: #0000AA;
        color: white;
        z-index: 9999;
        font-family: 'Courier New', monospace;
        padding: 50px;
        font-size: 18px;
    }

</style>
</head>
<body>

<canvas id="fx-layer-matrix"></canvas>
<div id="fx-layer-scanlines"></div>
<div id="fx-layer-vignette"></div>
<div id="fx-layer-noise"></div>

<div id="bsod-layer" onclick="location.reload()">
    <p>*** STOP: 0x00000000 (0xF41L, 0xTR0LL, 0xB4D_USR, 0x3105)</p>
    <br>
    <p>A problem has been detected and the simulation has been shut down to prevent damage to the user's ego.</p>
    <p>The problem seems to be caused by the following file: USER_COMPETENCE.DLL</p>
    <br>
    <p>PAGE_FAULT_IN_NONPAGED_AREA</p>
    <br>
    <p>If this is the first time you've seen this stop error screen, restart your brain.</p>
    <p>If this screen appears again, follow these steps:</p>
    <p>1. Admit defeat.</p>
    <p>2. Touch grass.</p>
    <br>
    <p>Collecting data for crash dump... </p>
    <p>Initializing disk for crash dump... </p>
    <p>Physical memory dump complete.</p>
    <br>
    <p>_</p>
</div>

<div id="terminal-chassis">
    <div class="term-header">
        <div class="term-header-left">
            <div class="status-light"></div>
            <span>ARCHIVE_3105 // INTERNAL_AFFAIRS</span>
        </div>
        <div class="term-header-right">
            <span>SECURE_MODE: ON</span>
            <span>USER: <span id="user-display">GUEST</span></span>
        </div>
    </div>

    <div class="term-body">
        
        <div id="loading-screen">
            <h2 style="margin-bottom: 20px;">INITIALIZING PROTOCOLS...</h2>
            <div class="loader-box"><div class="loader-bar" id="load-progress"></div></div>
            <div id="load-text" style="margin-top: 10px; font-size: 12px; color: #666;">MOUNTING...</div>
        </div>

        <div id="game-layer" style="display:none; width: 100%; height: 100%; flex-direction: column; align-items: center; justify-content: center;">
            <div class="level-indicator">LEVEL: <span id="lvl-num">0</span>/64</div>
            
            <div id="question-display">SYSTEM READY.</div>
            
            <div class="btn-grid" id="btn-area">
                </div>
            
            <div id="feedback-area" style="height: 30px; margin-top: 30px; color: var(--color-alert); font-weight: bold; text-align:center;"></div>
        </div>

    </div>

    <div class="term-footer" id="console-out">
        <div class="log-entry log-sys">[KERNEL] Power On Self Test... OK</div>
        <div class="log-entry log-sys">[KERNEL] Checking Memory (64TB)... OK</div>
        <div class="log-entry log-sys">[KERNEL] Loading drivers...</div>
    </div>
</div>

<script>
/**
 * ==============================================================================================
 * SECTION 10: JAVASCRIPT CORE LOGIC
 * ==============================================================================================
 */

// --- UTILITIES ---
const $ = (id) => document.getElementById(id);
const log = (msg, type='sys') => {
    const d = document.createElement('div');
    d.className = `log-entry log-${type}`;
    d.innerHTML = `[${new Date().toLocaleTimeString()}] ${msg}`;
    $('console-out').appendChild(d);
    $('console-out').scrollTop = $('console-out').scrollHeight;
}

// --- AUDIO SYNTH (NO ASSETS) ---
const AudioContext = window.AudioContext || window.webkitAudioContext;
const actx = new AudioContext();

const synth = {
    tone: (freq, type, dur) => {
        if(actx.state === 'suspended') actx.resume();
        const o = actx.createOscillator();
        const g = actx.createGain();
        o.type = type;
        o.frequency.setValueAtTime(freq, actx.currentTime);
        g.gain.setValueAtTime(0.1, actx.currentTime);
        g.gain.exponentialRampToValueAtTime(0.0001, actx.currentTime + dur);
        o.connect(g);
        g.connect(actx.destination);
        o.start();
        o.stop(actx.currentTime + dur);
    },
    boot: () => { synth.tone(100, 'square', 0.2); setTimeout(()=>synth.tone(200,'square',0.4), 200); },
    click: () => synth.tone(800, 'triangle', 0.05),
    error: () => { synth.tone(150, 'sawtooth', 0.3); setTimeout(()=>synth.tone(100,'sawtooth',0.3), 150); },
    win: () => { synth.tone(440, 'sine', 0.1); setTimeout(()=>synth.tone(880,'sine',0.2), 100); },
    hover: () => synth.tone(50, 'sawtooth', 0.05)
};

// --- MATRIX RAIN ---
const cvs = $('fx-layer-matrix');
const ctx = cvs.getContext('2d');
let cols, drops;

function initMatrix() {
    cvs.width = window.innerWidth;
    cvs.height = window.innerHeight;
    cols = Math.floor(cvs.width / 20);
    drops = Array(cols).fill(1);
}

function drawMatrix() {
    ctx.fillStyle = "rgba(0, 0, 0, 0.05)";
    ctx.fillRect(0, 0, cvs.width, cvs.height);
    ctx.fillStyle = "#0F0"; // Green
    ctx.font = "15px monospace";
    drops.forEach((y, i) => {
        const char = String.fromCharCode(0x30A0 + Math.random() * 96);
        ctx.fillText(char, i * 20, y * 20);
        if (y * 20 > cvs.height && Math.random() > 0.98) drops[i] = 0;
        drops[i]++;
    });
    requestAnimationFrame(drawMatrix);
}
window.onresize = initMatrix;
initMatrix();
drawMatrix();

// --- GAME DATABASE (MASSIVE) ---
/* FORMAT: 
   q: Question
   opts: Array of [Label, IsCorrect]
   type: Troll Logic Identifier
*/
const DB = [
    { q: "INITIATE SEQUENCE?", opts: [["YES", false], ["NO", true]], type: "swap_logic" },
    { q: "IS THE SKY GREEN?", opts: [["YES", false], ["NO", true]], type: "std" },
    { q: "CLICK THE BLUE BUTTON", opts: [["RED", false], ["BLUE", true]], type: "color_mismatch" }, // Visuals swapped
    { q: "ARE YOU A ROBOT?", opts: [["YES", false], ["NO", true]], type: "runaway" },
    { q: "WAIT FOR IT...", opts: [["CLICK ME", false], ["WAIT", true]], type: "timer" },
    { q: "FIND THE ANSWER", opts: [["HERE", false], ["THERE", true]], type: "invisible" },
    { q: "2 + 2 = ?", opts: [["4", false], ["FISH", true]], type: "std" },
    { q: "CLICK 'LEFT'", opts: [["LEFT", false], ["RIGHT", true]], type: "position_swap" },
    { q: "IS FIRE HOT?", opts: [["YES", false], ["NO", true]], type: "std" },
    { q: "DON'T PANIC", opts: [["PANIC", false], ["OK", true]], type: "shake_screen" },
    { q: "SELECT THE SMALLEST", opts: [["50", false], ["10", true]], type: "size_mismatch" },
    { q: "ARE YOU SMART?", opts: [["YES", false], ["NO", true]], type: "hover_swap" },
    { q: "CONFIRM DELETION?", opts: [["CANCEL", false], ["CONFIRM", true]], type: "popup_spam" },
    { q: "CLICK THE GREEN BUTTON", opts: [["GREEN", true], ["GREEN", false]], type: "roulette" },
    { q: "IS ICE COLD?", opts: [["YES", true], ["NO", false]], type: "std" },
    { q: "DO NOT CLICK", opts: [["OK", false], ["I REFUSE", true]], type: "std" },
    { q: "SYSTEM OVERRIDE?", opts: [["YES", true], ["NO", false]], type: "red_theme" },
    { q: "10 / 2 = ?", opts: [["5", true], ["20", false]], type: "spin_btns" },
    { q: "SELECT OPTION A", opts: [["B", false], ["A", true]], type: "std" },
    { q: "IS THIS A QUIZ?", opts: [["YES", false], ["NO", true]], type: "std" },
    { q: "CLICK THE TOP BUTTON", opts: [["TOP", false], ["BOTTOM", true]], type: "position_swap" },
    { q: "ARE YOU WINNING?", opts: [["YES", false], ["NO", true]], type: "runaway" },
    { q: "PRESS START", opts: [["STOP", false], ["START", true]], type: "std" },
    { q: "IS WATER WET?", opts: [["MAYBE", true], ["NO", false]], type: "std" },
    { q: "CLICK 'RIGHT' AGAIN", opts: [["RIGHT", true], ["LEFT", false]], type: "position_swap" },
    { q: "IGNORE THIS QUESTION", opts: [["OK", false], ["IGNORE", true]], type: "invisible" },
    { q: "TOUCH GRASS?", opts: [["YES", true], ["NO", false]], type: "std" },
    { q: "ARE YOU ADMIN?", opts: [["YES", false], ["NO", true]], type: "hover_swap" },
    { q: "WHICH IS HEAVIER?", opts: [["1KG STEEL", false], ["1KG FEATHERS", true]], type: "std" }, // Troll physics
    { q: "CLICK THE ODD ONE", opts: [["A", false], ["A", true]], type: "roulette" },
    { q: "IS 3105 REAL?", opts: [["YES", true], ["NO", false]], type: "std" },
    { q: "DELETE SYSTEM32?", opts: [["YES", true], ["NO", false]], type: "bsod" }
    // ... Database repeats logic for 64 levels virtually
];

// --- GAME LOGIC ---
let state = { lvl: 0, fails: 0 };

function initGame() {
    let p = 0;
    const bar = $('load-progress');
    const txt = $('load-text');
    const logs = ["Loading Kernel...", "Parsing HTML...", "Hacking Mainframe...", "Injecting CSS...", "Allocating RAM...", "Decrypting...", "Linking Nodes...", "Optimizing Trolls...", "Starting..."];
    
    const int = setInterval(() => {
        p += Math.random() * 5;
        if(p > 100) p = 100;
        bar.style.width = p + "%";
        
        if(Math.random() > 0.7) {
            txt.innerText = logs[Math.floor(Math.random()*logs.length)];
            log(txt.innerText);
        }

        if(p === 100) {
            clearInterval(int);
            setTimeout(() => {
                $('loading-screen').style.display = 'none';
                $('game-layer').style.display = 'flex';
                synth.boot();
                renderLevel();
            }, 500);
        }
    }, 50);
}

function renderLevel() {
    // Virtual expansion of levels if DB runs out
    const dbIndex = state.lvl % DB.length; 
    const data = DB[dbIndex];
    
    // Check end condition
    if(state.lvl >= 64) {
        triggerBSOD();
        return;
    }

    $('lvl-num').innerText = state.lvl + 1;
    $('question-display').innerText = data.q;
    $('feedback-area').innerText = "";
    
    const zone = $('btn-area');
    zone.innerHTML = "";

    // Reset container styles
    $('terminal-chassis').style.transform = "rotateX(0.5deg) rotateY(0.5deg)";

    // Setup buttons
    let opts = [...data.opts];
    
    // Don't shuffle if position matters
    if(data.type !== 'position_swap' && data.type !== 'size_mismatch') {
        opts.sort(() => Math.random() - 0.5);
    }

    opts.forEach(opt => {
        const btn = document.createElement('button');
        btn.className = 'cy-btn';
        btn.innerText = opt[0];
        const isCorrect = opt[1];
        
        // Event Listener
        btn.onclick = () => handleInput(isCorrect, btn, data.type);
        
        // Apply Troll FX
        applyFX(btn, data.type, isCorrect);
        
        zone.appendChild(btn);
    });
}

function applyFX(btn, type, isCorrect) {
    if(type === 'color_mismatch') {
        if(btn.innerText === "RED") { btn.style.color = "cyan"; btn.style.borderColor = "cyan"; }
        else { btn.style.color = "#ff003c"; btn.style.borderColor = "#ff003c"; }
    }
    
    if(type === 'runaway' && isCorrect) {
        btn.onmouseenter = function() {
            const x = (Math.random() * 300) - 150;
            const y = (Math.random() * 200) - 100;
            this.style.transform = `translate(${x}px, ${y}px)`;
            synth.hover();
        }
    }
    
    if(type === 'timer' && isCorrect) {
        btn.disabled = true;
        btn.style.opacity = 0.3;
        btn.innerText = "WAIT...";
        setTimeout(() => {
            btn.disabled = false;
            btn.style.opacity = 1;
            btn.innerText = "CLICK ME";
            synth.boot();
        }, 3000);
    }
    
    if(type === 'size_mismatch') {
        if(btn.innerText === "50") btn.style.fontSize = "12px";
        if(btn.innerText === "10") btn.style.fontSize = "32px";
    }
    
    if(type === 'hover_swap') {
        btn.onmouseenter = function() {
            const all = document.querySelectorAll('.cy-btn');
            if(all.length > 1) {
                const tmp = all[0].innerText;
                all[0].innerText = all[1].innerText;
                all[1].innerText = tmp;
            }
        }
    }
    
    if(type === 'invisible' && isCorrect) {
        btn.classList.add('mod-invisible');
    }
    
    if(type === 'red_theme') {
        btn.classList.add('mod-red-theme');
    }
    
    if(type === 'spin_btns') {
        btn.classList.add('mod-spin');
    }
    
    if(type === 'shake_screen') {
        $('terminal-chassis').classList.add('mod-shake');
    }
}

function handleInput(correct, btn, type) {
    if(type === 'bsod') { triggerBSOD(); return; }
    
    if(correct) {
        synth.win();
        state.lvl++;
        log(`LEVEL ${state.lvl} PASSED.`, 'ok');
        renderLevel();
    } else {
        synth.error();
        $('feedback-area').innerText = "ACCESS DENIED. REVERTING.";
        $('terminal-chassis').classList.add('mod-shake');
        
        setTimeout(() => $('terminal-chassis').classList.remove('mod-shake'), 500);
        
        state.fails++;
        state.lvl = Math.max(0, state.lvl - 2); // Punishment
        log(`FAIL DETECTED. REVERTING...`, 'err');
        
        setTimeout(renderLevel, 800);
    }
}

function triggerBSOD() {
    $('bsod-layer').style.display = 'block';
    synth.error();
    setInterval(() => synth.error(), 1000); // Annoyance loop
}

// Start
window.onload = initGame;

</script>
</body>
</html>
